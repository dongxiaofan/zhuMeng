{"version":3,"file":"utils.js","sources":["uni_modules/lime-echart/components/l-echart/utils.js"],"sourcesContent":["// @ts-nocheck\r\n/**\n * 获取设备基础信息\n *\n * @see [uni.getDeviceInfo](https://uniapp.dcloud.net.cn/api/system/getDeviceInfo.html)\n */\nexport function getDeviceInfo() {\n\tif (uni.getDeviceInfo || uni.canIUse('getDeviceInfo')) {\n\t\treturn uni.getDeviceInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\n\n/**\n * 获取窗口信息\n *\n * @see [uni.getWindowInfo](https://uniapp.dcloud.net.cn/api/system/getWindowInfo.html)\n */\nexport function getWindowInfo() {\n\tif (uni.getWindowInfo || uni.canIUse('getWindowInfo')) {\n\t\treturn uni.getWindowInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\n\n/**\n * 获取APP基础信息\n *\n * @see [uni.getAppBaseInfo](https://uniapp.dcloud.net.cn/api/system/getAppBaseInfo.html)\n */\nexport function getAppBaseInfo() {\n\tif (uni.getAppBaseInfo || uni.canIUse('getAppBaseInfo')) {\n\t\treturn uni.getAppBaseInfo();\n\t} else {\n\t\treturn uni.getSystemInfoSync();\n\t}\n}\r\n\r\n\r\n// #ifndef APP-NVUE\r\n// 计算版本\r\nexport function compareVersion(v1, v2) {\r\n\tv1 = v1.split('.')\r\n\tv2 = v2.split('.')\r\n\tconst len = Math.max(v1.length, v2.length)\r\n\twhile (v1.length < len) {\r\n\t\tv1.push('0')\r\n\t}\r\n\twhile (v2.length < len) {\r\n\t\tv2.push('0')\r\n\t}\r\n\tfor (let i = 0; i < len; i++) {\r\n\t\tconst num1 = parseInt(v1[i], 10)\r\n\t\tconst num2 = parseInt(v2[i], 10)\r\n\r\n\t\tif (num1 > num2) {\r\n\t\t\treturn 1\r\n\t\t} else if (num1 < num2) {\r\n\t\t\treturn -1\r\n\t\t}\r\n\t}\r\n\treturn 0\r\n}\r\n// const systemInfo = uni.getSystemInfoSync();\r\n\r\nfunction gte(version) {\r\n\t// 截止 2023-03-22 mac pc小程序不支持 canvas 2d\r\n\t// let {\r\n\t// \tSDKVersion,\r\n\t// \tplatform\r\n\t// } = systemInfo;\r\n\tconst { platform } = getDeviceInfo();\r\n\tlet { SDKVersion } = getAppBaseInfo();\r\n\t// #ifdef MP-ALIPAY\r\n\tSDKVersion = my.SDKVersion\r\n\t// #endif\r\n\t// #ifdef MP-WEIXIN\r\n\treturn platform !== 'mac' && compareVersion(SDKVersion, version) >= 0;\r\n\t// #endif\r\n\treturn compareVersion(SDKVersion, version) >= 0;\r\n}\r\n\r\n\r\nexport function canIUseCanvas2d() {\r\n\t// #ifdef MP-WEIXIN\r\n\treturn gte('2.9.0');\r\n\t// #endif\r\n\t// #ifdef MP-ALIPAY\r\n\treturn gte('2.7.0');\r\n\t// #endif\r\n\t// #ifdef MP-TOUTIAO\r\n\treturn gte('1.78.0');\r\n\t// #endif\r\n\treturn false\r\n}\r\n\r\nexport function convertTouchesToArray(touches) {\r\n\t// 如果 touches 是一个数组，则直接返回它\r\n\tif (Array.isArray(touches)) {\r\n\t\treturn touches;\r\n\t}\r\n\t// 如果touches是一个对象，则转换为数组\r\n\tif (typeof touches === 'object' && touches !== null) {\r\n\t\treturn Object.values(touches);\r\n\t}\r\n\t// 对于其他类型，直接返回它\r\n\treturn touches;\r\n}\r\n\r\nexport function wrapTouch(event) {\r\n\tevent.touches = convertTouchesToArray(event.touches)\r\n\tfor (let i = 0; i < event.touches.length; ++i) {\r\n\t\tconst touch = event.touches[i];\r\n\t\ttouch.offsetX = touch.x;\r\n\t\ttouch.offsetY = touch.y;\r\n\t}\r\n\treturn event;\r\n}\r\n// export const devicePixelRatio = uni.getSystemInfoSync().pixelRatio\r\nexport const devicePixelRatio = getWindowInfo().pixelRatio;\r\n// #endif\r\n// #ifdef APP-NVUE\r\nexport function base64ToPath(base64) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst [, format, bodyData] = /data:image\\/(\\w+);base64,(.*)/.exec(base64) || [];\r\n\t\tconst bitmap = new plus.nativeObj.Bitmap('bitmap' + Date.now())\r\n\t\tbitmap.loadBase64Data(base64, () => {\r\n\t\t\tif (!format) {\r\n\t\t\t\treject(new Error('ERROR_BASE64SRC_PARSE'))\r\n\t\t\t}\r\n\t\t\tconst time = new Date().getTime();\r\n\t\t\tconst filePath = `_doc/uniapp_temp/${time}.${format}`\r\n\r\n\t\t\tbitmap.save(filePath, {},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tbitmap.clear()\r\n\t\t\t\t\tresolve(filePath)\r\n\t\t\t\t},\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tbitmap.clear()\r\n\t\t\t\t\tconsole.error(`${JSON.stringify(error)}`)\r\n\t\t\t\t\treject(error)\r\n\t\t\t\t})\r\n\t\t}, (error) => {\r\n\t\t\tbitmap.clear()\r\n\t\t\tconsole.error(`${JSON.stringify(error)}`)\r\n\t\t\treject(error)\r\n\t\t})\r\n\t})\r\n}\r\n// #endif\r\n\r\n\r\nexport function sleep(time) {\r\n\treturn new Promise((resolve) => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tresolve(true)\r\n\t\t}, time)\r\n\t})\r\n}\r\n\r\n\r\nexport function getRect(selector, context, node) {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst dom = uni.createSelectorQuery().in(context).select(selector);\r\n\t\tconst result = (rect) => {\r\n\t\t\tif (rect) {\r\n\t\t\t\tresolve(rect)\r\n\t\t\t} else {\r\n\t\t\t\treject()\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!node) {\r\n\t\t\tdom.boundingClientRect(result).exec()\r\n\t\t} else {\r\n\t\t\tdom.fields({\r\n\t\t\t\tnode: true,\r\n\t\t\t\tsize: true,\r\n\t\t\t\trect: true\r\n\t\t\t}, result).exec()\r\n\t\t}\r\n\t});\r\n};"],"names":["uni"],"mappings":";;AAMO,SAAS,gBAAgB;AAC/B,MAAIA,cAAG,MAAC,iBAAiBA,cAAG,MAAC,QAAQ,eAAe,GAAG;AACtD,WAAOA,cAAAA,MAAI;EACb,OAAQ;AACN,WAAOA,cAAAA,MAAI;EACX;AACF;AAOO,SAAS,gBAAgB;AAC/B,MAAIA,cAAG,MAAC,iBAAiBA,cAAG,MAAC,QAAQ,eAAe,GAAG;AACtD,WAAOA,cAAAA,MAAI;EACb,OAAQ;AACN,WAAOA,cAAAA,MAAI;EACX;AACF;AAOO,SAAS,iBAAiB;AAChC,MAAIA,cAAG,MAAC,kBAAkBA,cAAG,MAAC,QAAQ,gBAAgB,GAAG;AACxD,WAAOA,cAAAA,MAAI;EACb,OAAQ;AACN,WAAOA,cAAAA,MAAI;EACX;AACF;AAKO,SAAS,eAAe,IAAI,IAAI;AACtC,OAAK,GAAG,MAAM,GAAG;AACjB,OAAK,GAAG,MAAM,GAAG;AACjB,QAAM,MAAM,KAAK,IAAI,GAAG,QAAQ,GAAG,MAAM;AACzC,SAAO,GAAG,SAAS,KAAK;AACvB,OAAG,KAAK,GAAG;AAAA,EACX;AACD,SAAO,GAAG,SAAS,KAAK;AACvB,OAAG,KAAK,GAAG;AAAA,EACX;AACD,WAAS,IAAI,GAAG,IAAI,KAAK,KAAK;AAC7B,UAAM,OAAO,SAAS,GAAG,CAAC,GAAG,EAAE;AAC/B,UAAM,OAAO,SAAS,GAAG,CAAC,GAAG,EAAE;AAE/B,QAAI,OAAO,MAAM;AAChB,aAAO;AAAA,IACV,WAAa,OAAO,MAAM;AACvB,aAAO;AAAA,IACP;AAAA,EACD;AACD,SAAO;AACR;AAGA,SAAS,IAAI,SAAS;AAMrB,QAAM,EAAE,aAAa;AACrB,MAAI,EAAE,eAAe;AAKrB,SAAO,aAAa,SAAS,eAAe,YAAY,OAAO,KAAK;AAGrE;AAGO,SAAS,kBAAkB;AAEjC,SAAO,IAAI,OAAO;AASnB;AAEO,SAAS,sBAAsB,SAAS;AAE9C,MAAI,MAAM,QAAQ,OAAO,GAAG;AAC3B,WAAO;AAAA,EACP;AAED,MAAI,OAAO,YAAY,YAAY,YAAY,MAAM;AACpD,WAAO,OAAO,OAAO,OAAO;AAAA,EAC5B;AAED,SAAO;AACR;AAEO,SAAS,UAAU,OAAO;AAChC,QAAM,UAAU,sBAAsB,MAAM,OAAO;AACnD,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,QAAQ,EAAE,GAAG;AAC9C,UAAM,QAAQ,MAAM,QAAQ,CAAC;AAC7B,UAAM,UAAU,MAAM;AACtB,UAAM,UAAU,MAAM;AAAA,EACtB;AACD,SAAO;AACR;AAEY,MAAC,mBAAmB,cAAa,EAAG;AAkCzC,SAAS,MAAM,MAAM;AAC3B,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC/B,eAAW,MAAM;AAChB,cAAQ,IAAI;AAAA,IACZ,GAAE,IAAI;AAAA,EACT,CAAE;AACF;AAGO,SAAS,QAAQ,UAAU,SAAS,MAAM;AAChD,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvC,UAAM,MAAMA,cAAG,MAAC,oBAAqB,EAAC,GAAG,OAAO,EAAE,OAAO,QAAQ;AACjE,UAAM,SAAS,CAAC,SAAS;AACxB,UAAI,MAAM;AACT,gBAAQ,IAAI;AAAA,MAChB,OAAU;AACN,eAAQ;AAAA,MACR;AAAA,IACD;AACD,QAAI,CAAC,MAAM;AACV,UAAI,mBAAmB,MAAM,EAAE,KAAM;AAAA,IACxC,OAAS;AACN,UAAI,OAAO;AAAA,QACV,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,MACV,GAAM,MAAM,EAAE,KAAM;AAAA,IACjB;AAAA,EACH,CAAE;AACF;;;;;;;;"}